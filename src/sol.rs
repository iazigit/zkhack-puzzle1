use crate::data::puzzle_data;
use ark_ec::{ProjectiveCurve, AffineCurve};
use ark_bls12_381::{G1Projective, Fq};
use ark_ff::{Zero, PrimeField};
use ark_serialize::CanonicalSerialize;
use ark_std::{str::FromStr, vec::Vec};
//use ark_r1cs_std::boolean::Boolean;


pub fn solve() -> Vec<u8> {
    let (_, ms, sigs) = puzzle_data();
    
    for msg in ms.iter() {
        let _b2hash = blake2s_simd::blake2s(msg);
       /*
        println!("{:?}", msg);
        println!("{:?}", b2hash.as_bytes());
   
        let tmp: Vec<Boolean<_>> = b2hash.as_bytes().to_vec().iter()
                               .flat_map(|b| b.to_bits_le().unwrap())
                               .collect();
        println!("{:?}", tmp);
        */

    }
    
    
    let coeffs = ["17121295165192798477398141883194054527357556231349225960384719603917541866005", "9636171419518656575910304215037628531920496894157528543752908236429008843990", "51388995000140394698966621768113434880891101679607178789365239263426281789493", "31424858696699957271147760877443739037800757773790014883365624864572394226236", "49525557255905938776497624223430087101403756758076373530911975031056004991405", "14504781232550571405798701858291351886846894737081650759213900778336672154047", "16500180090612460848470019341088971179635467986886523956854661013323878074451", "5197805967700977819929700611147434080914008399374382599012666045517515889689", "38879008312468821241129249393892125792689578238031720526465799525185573264691", "10095213343102267783470178454275627113005564805131868053124021899876761592150", "3300902246161942597877418722062447115660618500962289696445190344341472390743", "1958555130017006175721425708255936262274099988609482242362690187452153434010", "22286939433768057340535441937428588055378365268293098666610738300380836111494", "5754227817259794691926808430067725408682053335423508007987441126378644962699", "20333986680464897592910597249120698671756446430118601735912530065225406437762", "39881173017280114890360951349180805153656841647756434657348704382348026235111", "34751237983844842086514049035015425553945600782069881594295339712340549662057", "31373521900254418596599988949190148533303176189995560196266268301283620786080", "8481580204909318148405201177601561920680492083952885516492884658160158752487", "47887223160976009525448797308358210716995244286600563119430822127760165551447", "14507563801702642378100123959589463992523074078367712873463715765103335054615", "28900204708984578338557641699051128571266716026679257648756767602029224773317", "15082952530029039033619382601638207335002846615679869292125478205156640124091", "19489999683060819179693768704476824907102168219468654771098146669917759765846", "34602715428675814387268694183051997863151716409137138852028246857552158999297", "32105983384345503907655263616779998154371223688829750614466735386746335742981", "43656176247268732543459786729329416717636647298907278049416373858371324647460", "33833739703165864197677546994704262501276276259523607840291341456162702345848", "49664686532328456862534052729148635369574536889115587421616569248030228787444", "43573927196886097740145214192253243809468689057129489561088510298487535328990", "28554875844269499650279826567127467399372522329300689586982423027677943842058", "4587472579481272856399559017678046523233487222829128417605993881285728664765", "6894444250995262768194298270634983084322323824422560436765843954483504661596", "3548980683431706838359827365746347900010676477996406276997849707925842489696", "46297968360014792180545231049539003293878190634343652396771547924489646361653", "3093313298711103991719878628594901734360877636673635771992988763453339608149", "37068810904803257710008262718952841631790036708190871656735256155704204140300", "43882192855230401392357024779547381545675890831984396354085715026952345816536", "48836212103966026502704111528228104863186063085854887625805117298657574830367", "35955585253962230417279256557595190422294331566059916628412242298237474104788", "17390824683715203064306035897615101282269994930723224711868194544538278588825", "15521975452580093189294930832406935861818760820893225318458336320016922937864", "3148576407422230442817598586184096065314114964881314908775346478305219644895", "15473148047272388496350186023732669786404204272467793157763249302756752483825", "2144557645812137940366248634959437408011706844227928031433410289038072362794", "15901722633580555574231381633798584713806189599043025896986594572356020672502", "18840079160394351594524243796065689097388646228935535888195097265237971287514", "9547635576354566174275670271766330593077072421212120561202738471730014158342", "2044684737025916930825027567241461845860079167510350007334896377515877916013", "12367088670902941906779865966061640445358849573615348063433374891310664361744", "23165278845543396555163729463530241392141023290355353359269686214583404449108", "19897669874087755080602474891531541598316980998065563297791760384064227176181", "26047429645536664306744971410236970091212767270306342265385995649702417469151", "37823649791521823473776856205360844229208321963925658659135160931558696371939", "41183532608670789366384979289027330383961662256025413446044953815860538193222", "50554819436083523054041987464650694742334549518800453779732186831629185423628", "26695141914648833690216426287693824030803500592656973774136497462543489563427", "28110778689988889171751356120073660550609695330060898577882501774018156471810", "10771936125520786340899262206970286106484354337488161431830168098354952958124", "14338290397766148481556978340479547415901382719460177264244409526527229845912", "22258389167140139742637810733844606084121724165967396718731743134693511393803", "41614003135267493308920588910722566684716559604723096813379988431050343009511", "49095214958015147736293682553162554412142615721101952475012357557782074438229", "9961600807038309177616790436094975208406163246599067639952546218772192402959", "46425810510995767421430079766730869034265421751091183701924938671972776777371", "20573922335482501700391456925099992128672989414931626711700150816849250655623", "14170654935505748000204810545768485841455837401549644184941878639345909090546", "26594466996392398549191271191739147121773285711898060758271525658109594100730", "26574657756917450350186885075248255467561909850881653045240765371269142376244", "17711085705856042883222975457855158898799929868531433221572320212210287824251", "7427104182546889879579085547698700026132945160690986812683772746537438875364", "29491216784753150827412533206612401756475388368392471350491494840670758294976", "1628233470558442260807101806889025496270544814982203263220543741010596438028", "25178322477420650316539229163647944675702617540445899425826269204408119527160", "31127113605242547637346130076332232031436889341271038471297495826446898217692", "38275055268458051790489382193550738118737278816183140944259397649907076003894", "3033268287728701330951545446709535364532607975172854752794308220005782040847", "12221597507417959718745010877951531285960830379041420845400665464503069769765", "32868840724990382538831730242640266615640506663157313168581966832643102791115", "45324516509830960840507436493046924277027847616125304246808515404343683105781", "41725751864124039833273602791030606597280163569350206104289040959476146019005", "1540725769422300815920358893109927692813576184616063937965194456721469342010", "8347396533592734646988882686577098056106421204192933019847946164198198166245", "9635418282675300065982021742984511395826203563047951686506597471966650191975", "45710580127427546028335408590431918068152589049231580309508280829897562881736", "26023604282549969852320964120989863334204000222888606427417251557594875646303", "26346687855365329398536694810987040783405774796165920107511343048619413181969", "42862891410379695310983225598815269165481955104994641774876021116184850356574", "31707717310844318338841543098037446559079883783920969904232435200123367076637", "41681670969843016166437201474835512874804566525087784046691157363872861612898", "37248274131261131016498798076753352917612654658386983262396771430025944995325", "17833343841346412610281676443618371059325313374332082739593447306158652139772", "35729481638828676014951685549469063141364723752260973798873095338015765402897", "19946541167740186585341048077908653919298123965668857093302754801980452255637", "33152006189454397207330107038495242937386056012697621643048135054764063798066", "22650953588980131044391991545694410151216347650038308178643246747662750440317", "49126786086683322958256684822244194750228984934848753090016516314598479365009", "404385091207133904713164461978129680241435671935609902382916246148687483768", "49007470345077921779361053838282097331987155513686708484279089537546500777911", "32929956069038945343793222977606151065871962578774447224468007741261687232797", "34130516640250374583399539579494474257471647730943298139414286791322969526974", "6056188001734517605167525459881389457819846361774018070479381310009284361008", "41720288820779372788857582279920832860346976913298016671800620304495680407189", "48082198714734773774275886550392360380718007959656667028686452278075307511430", "1533184065366901934906412504262687894246780139372779246259123428339433049349", "23588282745081034896371208439639544540998984607928675970995029085184589315974", "40617429086877882153417894891110035722929129584929721425449134572232111605270", "27572426758339739344723366222072512808673629536614631510137007707104872659620", "18432935627854278442540019807924095324235229132040012635120256742409501754479", "47320652015347753292073639240078299091044240217534956063427527481127618902332", "21079392915464248097732416451087230663485126262909143319999734857269430336349", "33920304698437896324616997865630585513022967648091125079094915571836964753987", "15441159991876645038497726125869878906833444680882314655243599572685266131287", "47083127526211043793868708689904416013654059554942456509984156013544185639322", "46730452749694985734811672857584413963565490123857260805910621570082550398028", "5547260979216115220276988201877609105230360111946476324929102466490098383743", "12589717986548945785381132517056799472992434667333469662151744406488068110614", "31263221116637455216399943975519027652668828327395124920794178300716339874931", "24910522641364101659446357911565449098304244009729554200155943111096492420218", "22830056900715619150399399885273499334621339353850511717069185547263050861934", "47768720595792629186834744546660620916498063843082993925039630888724089174727", "35489108877968386909505209446082845287437751537970246455536364031863366117077", "25123576851053070893557389524032936875182289527446917610560656801098170662034", "26236766538815122723182317081316716626551165333907086688171401763867474556452", "36464661992619012009084184073109267753566008049930948867598555490131547524697", "36068158374003815547498837966647262199898734858810264263520770149663006980580", "15585388024539062454806629149952102055910731849883324217351336896346322929785", "10342988550550377824857251538426530592710422600796295052934889094075640468140", "51423557154083607540642483158380835809868188517182810519190361085998944092132", "29084402131062983587624889521577392503417454297237301108279888900309633509184", "17839688267577252551041998636455942200621783507127940571903320328929382539743", "16432140303915358755495911696279401754626505613058399849630310534927919062934", "13951929052958773711764191016494999878589132725625922670293657286463407603132", "42004951471329826006756082608087633869642353418763070792362595960921621985484", "23312556163643370809517211916594759254384382586662606868238875203725333252573", "7586264022059387141113045310823487879676225596392386858795513061594721158782", "2865143272691485626692025766389236255514317366661997564154610277849763710024", "20427559418892794744130545807914588343537389751544408148893623268695480689571", "4610387908030417671805447396616956335687511623166483335315752321966017615186", "24693970411508269343252747691419742338682427521903520105456124254952591333957", "31435696823946224153916010581930017607303773344220655139051447213394639229425", "9168067948194420623758597590939060994976091137266637700565706108974527521638", "3488796353821032568198034102007767027769401276593042106674346391706582393230", "3522583076113653698572770147855869208972055763100550449402931800398886097139", "21426463659886833811350488758195739431380375109283770651779597603037522550346", "9614923588754803606377973785958345452409106428954378372727063230589423974456", "5957833170951441692146751216740019172354719279558605428323642063087586883497", "29188064237058745811172612321105024158186741462732985960577787042456805239412", "23851595850231930028284398374970840042381918561035150857066440890270476844457", "26124810877755421576890614821981060830717667723253279707836590012474952684732", "41549036506702481364880132900999280921530700824515575070264964892343132487499", "43690345006412758707405060113264240142671534248373714226173481318995002867520", "1047889631936937065197829681510546075854253862308677297664607052083380935437", "6504745591854753627969955772565208429645468603426712576979249781126696497668", "16312642649093118415524863427202400253681744776472917187806493714728176405439", "45230344400713363101901694807303258451388673046672763794251900050045756069171", "2024357679243591750749137108006616739946625917933763463816772499609700610585", "22654649667517989879181535692916668381593454489783922380985715521890329587074", "29820537203540262944860986943787329226839180440295273586791303519391737021768", "21654328893622157701910726777337525508257080802435440903316020641279838053804", "15332882028631768042548004168890115072820172554344491468590864016957027815320", "45762264140858590635949373177213267190794525818169417008053053385077688983776", "38124873322216214808238221482501871366568810097457498331477828767935278139766", "9354705342640914992379408726573560243826329667171364585179243125244281503419", "31245605032720037591492989487645104080481060428421342550525695875975346953172", "27144066422496993514073895626563600576525866808776960695673752716472994791072", "27501481657457954914430661421409362874394783031720777274323365091706548817875", "29066217012369974070232891343322500345136166461493541553471361380317808549970", "45370042509371617467479049326918626033348176737946310004581270009016568909002", "25258255435022948257996612330711928313789560543869188026813573722067997797276", "44432782622110594719778197618441096303082153066000090339131687237234999689681", "16000427445475973329147332592173815354063611481108174740609244979815617207625", "15205908637278027106084264884272788361009641921351658079188337833539535394830", "3162304379027191930007216370386232027128860524342499001690619875460346981821", "32060980396214526464719951478613666056101053852292286027764348394292890721630", "14308487864745498137250393105584409177869393281765355951290547548056309421776", "36710745328414364369201268925576453750494504656837121744824833201272579185084", "48241431102841707712349084812423784631102982690621281646539631859357619571071", "13243795819078316292076259076223466934334779924781706494198638227194535456233", "15847473635999507321812451601420923607572384486784436770052338993705591080669", "8555111923346803333388007884471394907657092403603921074322416242595771199355", "22693886759880136349741833180636091011178867905138303665030853531868390912996", "13540932170132363757261268731387925821223310850934890873818404948242815429735", "38679668763540278980455308232495933012234960815920775656546502298956675288326", "39980185917801558597283610883895075651661228709449561195773319416989194145951", "22436300877585413192346714885472209978818314461858251694515597528735862052454", "40343886373341031113019717677999193842061945776985375089862866392234569986134", "19138848185569747047278776599882125000899505702073777451097539161495862462371", "4362385130512634657997930953835276829082745205098140703758028214063970972874", "18268551138982178266162129662134448860069743307473170489303747369632716488911", "22830590373475453750731982434919681229516621829780040002841113460998372472230", "41819526202502317994570097904597699920174117407312879110285047404620919387940", "48502998738619534295891793764069016408000832351156401431177516526644783307003", "22003037842598232139285900839740237621437364661643729112088741737598898087567", "47812367446554329343636635634610554037824314016162780260412159662069783348569", "3154086053847636736835213625101802774461258998339829197651771974092026854099", "24393883428807377158759761151455717414348488193443307772069573335947251195280", "36575694359781544848799608612928382665243439732985946531515630124381415571335", "23727754379575228083106828167431958829876670272699656848100504288351248192614", "24992279351076008390277209024655421358556715370826125524085868124089405706694", "8231851494452025732397217829151112007660159520311204618018054191395303513888", "49975846260748851324844970953596980527811054012840325605020299215824811334353", "35844043061320073255416428432593597182717111084331290916183256883623619845290", "2755370339636570943566531509544170716380832046926443167170044151313495022004", "48951902056259686577128850483702415838349023960968582325520751998312944147754", "5008769053798453058144594577355409366459915484423054224839963941261414051522", "27503569189120689269549179565143126284452054837365229567429536140819641973017", "38915120460987476072163666440710069373101294104122701792598373104874960048004", "39924195147383134005458392248674171932232330492269560032262059304042846387712", "23962961051992647210030621437508502189221779373963666764076214523328124746530", "49686397002631328381516988236509255179307569496997945947453151380654812452817", "18741866164422182321638553055012254339334764874074122594730491541982529185349", "9597476149775115825657206106631520771092317742156455177011272988236078539110", "26244248017751716130162564590527855327772559798141648450364888874904414962628", "35282957115974364703526775056843708993596935313267756653813146665533974884130", "12842675737065628474632986080992037281756752762695405627543173931937381117291", "3708997681175067912091323037802968624751445662692079150795697453388305822033", "28092136208438695447720647773784180826179772976072061835008299991600384549089", "22472515088349015853361453452403789800949485211073105268794271193785953247819", "39954617252827360421734226154916470283375409439258449247621250958540298209408", "27358684029761429502300647459302489854858132089749343656383051799679337979689", "13716128287279764487393241245883461119768518353523076936989242988929535176104", "28288678837601469062842802773306462368690008424423338377774417948208747319012", "47592055536405029092339782996988233876487271008592931677086035932723182973389", "17480201716579009914814914158561277133362357381604286888531072018072539398176", "51131134808927667363925370179767670317260230917288915516360130837631371714768", "10742674999412013881158463239488139270088795692231834639010078006659217276633", "2892980414574085030874526506740788422657397727126130993431129235423957482342", "18857958790747016326637495470798309468690992788914637441284198124383239980713", "18443532019361475999681631306270362168293143282180538205047009291225710022016", "9009491233404090151953013977758486577877389918049515536464924453295960283210", "28113088390848107652854092215594975056668746773399824388112681488215918286459", "29234049900911813353775258067065701374115507415547563455189772303494573175131", "27285865806127580867942911787150794137205048564178441570628953344756205935133", "44527017834433201802698464861956979285589424350115907688110503956815200692898", "23947264890257654677963054226959446189334475147408731568926349191092205839833", "658744190246567571215593148312752487024000612975329465388227942843240731290", "14382398350447913365563483003037807237474729067363741564859796689898078918841", "36043535075257084454463450260968971949547187914812251549373359872671746739262", "37939211602800307786163688549016533172055032777993102483929657446541835916583", "31496159645431942805101605399189109926371770167260538761845906696211079368266", "13867937494631833150661328183813630843764859811747395088677018378954254971673", "12575375821244088323684668281445855725160069274818980276377060631942604655698", "5979248495183133671835764239393143329913926287469515346856087392489040280489", "14741562112879971756702403469850892899322630994943130409532794535931220079791", "21234170993539928778844616688332010268048240121190556628972829175403870597794", "29723554400388091862732025535160596267834604954142322454904265580783008927650", "20293521227201079402933918349221553337755738672859107947591069351270008558029", "34649234614756210618544994567249447873624962539742034871307165769320023298509", "38999880592829631145646049145236491707616798507059055299128159845807543313555", "33520114536689951366466240495815314417745406938156127955803434438713393472167", "25952736779088797535128772125903340628347858274222956353257113946386716688694", "30923549176094827250448096063196605026509818373952472386865066309735758443855", "2305072483250879663534286263324763945608204387250748669284794675545756460069", "2123185896501945075800257997398555071478521794237396499251707916503771240535", "49390446628047614637332174504106379710915243780603397873329189317056717600981"];
    //coeffs.reverse();
    println!("{:?}", coeffs[0]);

    let mut sig_sum = G1Projective::zero();
    for i in 0..coeffs.len() {
        let c = Fq::from_str(coeffs[i]).unwrap();
        let sig = sigs[i].into_projective();
        let tmp = sig.mul(&c.into_repr());
        sig_sum += tmp;
        
    }
    let mut result = Vec::new();
    sig_sum.into_affine().serialize(&mut result).unwrap();
    result
}
